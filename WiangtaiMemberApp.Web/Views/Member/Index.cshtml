@{
    ViewData["Title"] = "Member";
    ViewBag.Breadcrumbs = new List<Breadcrumb>()
{
        new Breadcrumb("Member", nameof(MemberController.Index), "Member", true)
    };
}

<div class="table-responsive">
    <table id="memberTable" class="table table-striped table-hover" style="width:100%">
    </table>
</div>

@section Links {
    <link rel="stylesheet" href="~/adminlte/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="~/adminlte/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" href="~/adminlte/plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
}

@section Scripts {
    <script src="~/adminlte/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/adminlte/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/adminlte/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/adminlte/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
    <script src="~/adminlte/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/adminlte/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
    <script src="~/adminlte/plugins/jszip/jszip.min.js"></script>
    <script src="~/adminlte/plugins/pdfmake/pdfmake.min.js"></script>
    <script src="~/adminlte/plugins/pdfmake/vfs_fonts.js"></script>
    <script src="~/adminlte/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
    <script src="~/adminlte/plugins/datatables-buttons/js/buttons.print.min.js"></script>
    <script src="~/adminlte/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>

    <script>
        $(document).ready(function () {
            alert("test");
            $('#memberTable').DataTable({
                serverSide: true,
                processing: true,
                responsive: true,
                filter: true,
                orderMulti: false,
                lengthMenu: [10, 25, 50],
                pageLength: 25,
                scrollX: true,
                select: {
                    style: 'multi'
                },
                search: {
                    return: true
                },
                language: {
                    emptyTable: 'No data available'
                },
                ajax: {
                    url: '@Url.Action("GetDataMembers", "Member")',
                    type: 'POST',
                    dataSrc: 'data',
                    dataType: 'json',
                    dataFilter: function (data) {
                        var jsonData = jQuery.parseJSON(data);

                        jsonData.draw = jsonData.draw;
                        jsonData.recordsTotal = jsonData.records_total;
                        jsonData.recordsFiltered = jsonData.records_filtered;
                        jsonData.data = jsonData.data;

                        return JSON.stringify(jsonData);
                    }
                },
                columnDefs: [
                    {
                        targets: 0,
                        type: 'datetime',
                        orderable: true,
                        searchable: false,
                        visible: false
                    },
                    {
                        targets: [ 1, 2, 3, 4, 5 ],
                        type: 'string',
                        orderable: true,
                        searchable: true
                    },
                    {
                        targets: -1,
                        orderable: false,
                        searchable: false,
                        width: '13%',
                    }
                ],
                columns: [
                    {
                        title: '',
                        name: 'CreatedDate',
                        data: 'created_date'
                    },
                    {
                        title: 'First Name',
                        name: 'FirstName',
                        data: 'first_name'
                    },
                    {
                        title: 'Last Name',
                        name: 'LastName',
                        data: 'last_name'
                    },
                    {
                        title: 'Display Name',
                        name: 'DisplayName',
                        data: 'display_name'
                    },
                    {
                        title: 'Email',
                        name: 'Email',
                        data: 'email'
                    },
                    {
                        title: 'Mobile',
                        name: 'Mobile',
                        data: 'mobile'
                    },
                    {
                        render: function(data, type, row) {
                            return '<a class="btn btn-sm" href="@Url.Action("Edit", "Member")/' + row.member_id + '"><i class="fas fa-edit"></i></a>' +
                                '<a class="btn btn-sm" href="#"><i class="fas fa-trash"></i></a>';
                        }
                    }
                ],
                order: [
                    [0, 'DESC']
                ],
                dom: "<'row'<'col-sm-12 col-md-3 col-lg-2 mb-1'l><'col-sm-12 col-md-9 col-lg-6 mb-1'B><'col-md-12 col-lg-4 mb-1'f>>" +
                     "<'row'<'col-sm-12'tr>>" +
                     "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
                buttons: {
                    dom: {
                        button: {
                            className: 'btn btn-secondary btn-sm'
                        }
                    },
                    buttons: [
                        {
                            text: '<i class="fas fa-plus-square"></i> Create Member',
                            action: function (e, dt, node, config) {
                                window.location.href = '@Url.Action("Create", "Member")'
                            }
                        },
                        {
                            extend: 'spacer',
                            type: 'empty'
                        },
                        {
                            text: '<i class="fas fa-check-square"></i> Check All',
                            extend: 'selectAll'
                        },
                        {
                            text: '<i class="fas fa-square"></i> Uncheck All',
                            extend: 'selectNone'
                        },
                        {
                            extend: 'spacer',
                            type: 'empty'
                        }
                    ]
                }
            });
        });
    </script>
}